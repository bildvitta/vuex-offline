{"version":3,"file":"index.min.js","sources":["../src/utils/find.js","../src/utils/findOne.js","../src/utils/formatResponse.js","../src/utils/formatError.js","../src/utils/getFieldsByType.js","../src/utils/setOptions.js","../src/utils/getFieldsWithRelationshipOptions.js","../src/utils/parseJSON.js","../src/utils/getFindQuery.js","../src/utils/mapJSON.js","../src/utils/nestField.js","../src/utils/setDefaults.js","../src/utils/statusResponse.js","../src/module/actions/update.js","../src/module/actions/index.js","../src/module/actions/create.js","../src/module/actions/destroy.js","../src/module/actions/fetchFilters.js","../src/module/actions/fetchList.js","../src/module/actions/fetchSingle.js","../src/module/actions/replace.js","../src/module/getters.js","../src/module/mutations.js","../src/module/state.js","../src/defaults/createDateTime.js","../src/defaults/createUUID.js","../src/index.js"],"sourcesContent":["import { database } from '../index.js'\n\n/**\n * @param {string} name\n * @param {object} query={object}\n * @returns {promise}\n * @example find('users', { isActive: true })\n */\nexport default function (name, query = {}) {\n  return database.collections[name].find({ selector: query }).exec()\n}\n","import { database } from '../index.js'\n\n/**\n * @param {string} name\n * @param {object | string} query={object | string}\n * @returns {promise}\n * @example findOne('users', 'my_uuid')\n */\nexport default function (name, query = {}) {\n  const queryParam = typeof query === 'object' ? { selector: query } : query\n\n  return database.collections[name].findOne(queryParam).exec()\n}\n","export default function (response) {\n  return {\n    data: {\n      status: { code: 200 },\n      ...response\n    }\n  }\n}\n","import { RxError } from 'rxdb/dist/es/rx-error.js'\nimport formatResponse from './formatResponse.js'\n\n// https://www.npmjs.com/package/is-my-json-valid#error-messages\nconst ptBR = {\n  'is required': 'Este campo é obrigatório.',\n  // 'is the wrong type': '',\n  // 'has additional items': '',\n  'must be FORMAT format': 'Este campo precisa ser FORMAT.',\n  'must be unique': 'Já existe um registro com este valor.',\n  'must be date-time format': 'Data invalida.',\n  // 'must be an enum value': '',\n  // 'dependencies not set': '',\n  // 'has additional properties': '',\n  // 'referenced schema does not match': '',\n  // 'negative schema matches': '',\n  // 'pattern mismatch': '',\n  // 'no schemas match': '',\n  // 'no (or more than one) schemas match': '',\n  // 'has a remainder': '',\n  'has more properties than allowed': 'Selecione menos propriedades.',\n  'has less properties than allowed': 'Selecione mais propriedades.',\n  'has more items than allowed': 'Selecione menos itens.',\n  'has less items than allowed': 'Selecione mais itens.',\n  'has longer length than allowed': 'O valor é muito grande.',\n  'has less length than allowed': 'O valor é muito pequeno.',\n  'is less than minimum': 'O valor é menor que o mínimo.',\n  'is more than maximum': 'O valor é maior que o máximo.'\n}\n\nconst localize = message => [ptBR[message] || message]\nconst labelize = label => label.replace('data.', '')\n\nexport default function (error, response = {}) {\n  if (!(error instanceof RxError)) {\n    throw error\n  }\n\n  const { errors: databaseErrors, obj: result } = error.parameters\n  const errors = {}\n\n  for (const { field, message } of databaseErrors) {\n    errors[labelize(field)] = localize(message)\n  }\n\n  return {\n    response: formatResponse({\n      status: { code: 400 }, errors, result, ...response\n    })\n  }\n}\n","export default function (fields = {}, type, callback) {\n  const filteredFields = {}\n\n  for (const key in fields) {\n    const field = fields[key]\n\n    if (field.type === type) {\n      filteredFields[key] = field\n      callback === 'function' && callback(field)\n    }\n  }\n\n  return filteredFields\n}\n","export default function (documents, { label, value }) {\n  return documents.map(document => ({\n    label: document[label],\n    value: document[value],\n    data: document.toJSON()\n  }))\n}\n","import setOptions from './setOptions.js'\n\nexport default async function ({ fields, idKey, parent, relationships }) {\n  fields = JSON.parse(JSON.stringify(fields))\n\n  for (const key in relationships) {\n    const relationship = relationships[key]\n    const { ref } = relationship\n\n    if (ref) {\n      if (!relationship.label) { relationship.label = idKey }\n      if (!relationship.value) { relationship.value = idKey }\n\n      const documents = await parent.collections[ref].find().exec()\n      fields[key].options = setOptions(documents, relationship)\n\n      continue\n    }\n\n    for (const relKey in relationship) {\n      const relRef = relationship[relKey].ref\n      const documents = await parent.collections[relRef].find().exec()\n\n      fields[key].children[relKey] = {\n        options: setOptions(documents, relationship[relKey]),\n        ...fields[key].children[relKey]\n      }\n    }\n  }\n\n  return fields\n}\n","export default function (value) {\n  try { return JSON.parse(value) } catch { return value }\n}\n","import parseJSON from './parseJSON.js'\n\nexport default function (moduleFilters = {}, { filters, search }) {\n  const { queryOperators, search: searchFilter } = moduleFilters\n  const filtersQuery = {}\n\n  for (const name in filters) {\n    const filter = filters[name]\n    const queryOperator = queryOperators[name]\n\n    if (!queryOperator) {\n      throw new Error(`The queryOperator is missing for filter \"${name}\".`)\n    }\n\n    if (typeof queryOperator === 'function') {\n      const { value, operator, model } = queryOperator(filter) || {}\n\n      filtersQuery[model || name] = {\n        ...filtersQuery[model || name],\n        [operator || '$regex']: parseJSON(value) \n      }\n\n      continue\n    }\n\n    filtersQuery[name] = { [queryOperator]: parseJSON(filter) }\n  }\n\n  if (search) {\n    filtersQuery.$or = (searchFilter || []).map(\n      item => ({ [item]: { $regex: new RegExp(search, 'gi') } })\n    )\n  }\n\n  return {\n    selector: { ...filtersQuery }\n  }\n}\n","export default function (array = []) {\n  return array.map(item => item.toJSON())\n}\n","export default function nestField (nested = [], destroyedKey = 'destroyed') {\n  if (!Array.isArray(nested)) {\n    throw new Error('Please provide a valid array.')\n  }\n\n  let index = 0\n\n  function hasNext () {\n    return index < nested.length\n  }\n\n  function next () {\n    return nested[index++]\n  }\n\n  while (hasNext()) {\n    const current = next()\n\n    if (current[destroyedKey]) {\n      index--\n      nested.splice(index, 1)\n      continue\n    }\n\n    for (const key in current) {\n      if (Array.isArray(current[key]) && current[key].length) {\n        nestField(nested[index - 1][key])\n      }\n    }\n  }\n\n  return nested\n}\n","export default function (defaults = {}) {\n  const response = {}\n\n  for (const key in defaults) {\n    const value = defaults[key]\n    response[key] = typeof value === 'function' ? value() : value\n  }\n\n  return response\n}\n","export default function (code, text) {\n  return {\n    data: {\n      status: { code, text }\n    }\n  }\n}\n","import {\n  formatError,\n  formatResponse,\n  getFieldsByType,\n  nestField,\n  setDefaults,\n  statusResponse\n} from '../../utils/index.js'\n\nexport default function ({ fields, updateDefaults }, collection) {\n  return async function ({ commit }, { payload, id }) {\n    payload = { ...payload, ...setDefaults(updateDefaults) }\n\n    try {\n      const document = await collection.findOne(id).exec()\n\n      if (!document) {\n        throw statusResponse(404, 'Not found')\n      }\n\n      getFieldsByType(fields, 'nested', ({ name }) => {\n        payload[name] = nestField(payload[name])\n      })\n\n      await document.update({ $set: payload })\n      const result = { ...document.toJSON(), ...payload }\n\n      commit('replaceItem', result)\n      return formatResponse({ result })\n    } catch (error) {\n      throw formatError(error)\n    }\n  }\n}\n","import create from './create.js'\nimport destroy from './destroy.js'\nimport fetchFilters from './fetchFilters.js'\nimport fetchList from './fetchList.js'\nimport fetchSingle from './fetchSingle.js'\nimport replace from './replace.js'\nimport update from './update.js'\n\nexport default {\n  create,\n  destroy,\n  fetchFilters,\n  fetchList,\n  fetchSingle,\n  replace,\n  update\n}\n","import {\n  formatError,\n  formatResponse,\n  getFieldsByType,\n  nestField,\n  setDefaults\n} from '../../utils/index.js'\n\nexport default function ({ defaults, fields }, collection) {\n  return async function ({ commit }, { payload }) {\n    payload = { ...setDefaults(defaults), ...payload }\n\n    try {\n      getFieldsByType(fields, 'nested', ({ name }) => {\n        payload[name] = nestField(payload[name])\n      })\n\n      const document = await collection.insert(payload)\n      const documentJSON = document.toJSON()\n\n      commit('setListItem', documentJSON)\n      return formatResponse({ result: documentJSON })\n    } catch (error) {\n      throw formatError(error)\n    }\n  }\n}\n","import {\n  formatResponse,\n  statusResponse\n} from '../../utils/index.js'\n\nexport default function (module, collection) {\n  return async function ({ commit }, { id }) {\n    try {\n      const document = await collection.findOne(id).exec()\n\n      if (!document) {\n        throw statusResponse(404, 'Not found')\n      }\n\n      const documentJSON = document.toJSON()\n      await document.remove()\n\n      commit('removeListItem', id)\n      return formatResponse({ result: documentJSON })\n    } catch (error) {\n      return error\n    }\n  }\n}\n","import {\n  formatResponse\n} from '../../utils/index.js'\n\nexport default function ({ filters }) {\n  return async function ({ commit }) {\n    try {\n      const { fields } = filters\n\n      commit('setFilters', fields)\n      return formatResponse({ fields })\n    } catch (error) {\n      return error\n    }\n  }\n}\n","import {\n  formatResponse,\n  getFindQuery,\n  getFieldsWithRelationshipOptions,\n  mapJSON\n} from '../../utils/index.js'\n\nexport default function (module, collection) {\n  return async function (\n    { commit },\n    { filters, findQuery, increment, limit, page = 1, search } = {}\n  ) {\n    if (!findQuery) {\n      findQuery = getFindQuery(module.filters, { filters, search })\n    }\n\n    try {\n      const query = collection.find(findQuery).sort(module.sort)\n      const documents = await query.exec()\n\n      const count = documents.length\n      const skip = (page - 1) * (limit || module.perPage)\n\n      const slicedDocuments = documents.slice(skip, skip + module.perPage)\n      const documentsJSON = mapJSON(slicedDocuments)\n\n      commit('setList', { count, increment, results: documentsJSON })\n\n      return formatResponse({\n        fields: await getFieldsWithRelationshipOptions(module),\n        results: documentsJSON\n      })\n    } catch (error) {\n      return error\n    }\n  }\n}\n","import {\n  formatResponse,\n  getFieldsWithRelationshipOptions,\n  statusResponse\n} from '../../utils/index.js'\n\nexport default function (module, collection) {\n  return async function ({ commit }, { form, id }) {\n    const fields = await getFieldsWithRelationshipOptions(module)\n\n    if (form && !id) {\n      return formatResponse({ fields })\n    }\n\n    try {\n      const document = await collection.findOne(id).exec()\n\n      if (!document) {\n        throw statusResponse(404, 'Not found')\n      }\n\n      const documentJSON = document.toJSON()\n      commit('replaceItem', documentJSON)\n\n      return formatResponse({ fields, result: documentJSON })\n    } catch (error) {\n      return error\n    }\n  }\n}\n","import update from './update.js'\n\nexport default function (module, collection) {\n  return update(module, collection)\n}\n","export default function ({ getters, idKey }) {\n  return {\n    list: state => state.list,\n    filters: state => state.filters,\n    totalPages: state => state.totalPages,\n\n    byId: state => id => state.list.find(item => item[idKey] === id),\n\n    ...getters\n  }\n}\n","export default function ({ idKey, mutations, perPage }) {\n  return {\n    setFilters (state, payload) {\n      state.filters = payload\n    },\n\n    setList (state, { count, increment, results = [] }) {\n      if (increment) {\n        state.list.push(...results)\n      } else {\n        state.list = results\n      }\n\n      state.totalPages = Math.ceil(count / perPage)\n    },\n\n    setListItem (state, payload = {}) {\n      state.list.push(payload)\n    },\n\n    setErrors (state, { model, hasError }) {\n      state[model] = !!hasError\n    },\n\n    replaceItem (state, payload) {\n      const index = state.list.findIndex(item => item[idKey] === payload[idKey])\n      ~index ? state.list.splice(index, 1, payload) : state.list.push(payload)\n    },\n\n    removeListItem (state, id) {\n      const index = state.list.findIndex(item => item[idKey] === id)\n      ~index && state.list.splice(index, 1)\n    },\n\n    ...mutations\n  }\n}\n","export default function ({ state }) {\n  return {\n    list: [],\n    filters: {},\n    totalPages: 0,\n\n    ...state\n  }\n}\n","export default function () {\n  return (new Date()).toISOString()\n}\n","export default function () {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, char =>\n    (char ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> char / 4)\n      .toString(16)\n  )\n}\n","import { addRxPlugin, createRxDatabase, PouchDB } from 'rxdb/plugins/core'\nimport { RxDBValidatePlugin } from 'rxdb/plugins/validate'\nimport { RxDBQueryBuilderPlugin } from 'rxdb/plugins/query-builder'\nimport { RxDBMigrationPlugin } from 'rxdb/plugins/migration'\nimport { RxDBReplicationPlugin } from 'rxdb/plugins/replication'\nimport { RxDBLeaderElectionPlugin } from 'rxdb/plugins/leader-election'\nimport { RxDBUpdatePlugin } from 'rxdb/plugins/update'\n\nimport { actions, getters, mutations, state } from './module/index.js'\n\nimport { find, findOne, nestField } from './utils/index.js'\nimport { createDateTime, createUUID } from './defaults/index.js'\n\nlet database = null\n\nexport default class {\n  constructor (options = {}) {\n    if (!options.database.name) {\n      throw new Error('Name is required.')\n    }\n\n    this.database = null\n    this.databaseOptions = options.database\n\n    this.idKey = options.idKey || 'id'\n    this.sync = options.sync\n    this.perPage = options.perPage || 12\n\n    this.collections = {}\n    this.modules = options.modules || []\n    this.storeModules = {}\n\n    // Middleware-hooks\n    // https://rxdb.info/middleware.html\n    this.hooks = options.hooks || [\n      'preInsert',\n      'postInsert',\n      'preSave',\n      'postSave',\n      'preRemove',\n      'postRemove',\n      'postCreate'\n    ]\n\n    // Types\n    this.types = options.types || [\n      'CREATE',\n      'DESTROY',\n      'FETCH_FILTERS',\n      'FETCH_LIST',\n      'FETCH_SINGLE',\n      'REPLACE',\n      'UPDATE'\n    ]\n  }\n\n  addDatabasePlugin (...plugins) {\n    for (const plugin of plugins) {\n      addRxPlugin(plugin)\n    }\n  }\n\n  async createDatabase () {\n    // Custom Build\n    // https://rxdb.info/custom-build.html\n    this.addDatabasePlugin(\n      RxDBValidatePlugin,\n      RxDBQueryBuilderPlugin,\n      RxDBMigrationPlugin,\n      RxDBReplicationPlugin,\n      RxDBLeaderElectionPlugin,\n      RxDBUpdatePlugin,\n\n      require('pouchdb-adapter-http'),\n      require('pouchdb-adapter-idb')\n    )\n\n    if (process.env.DEBUGGING) {\n      this.addDatabasePlugin(\n        require('rxdb/plugins/dev-mode').RxDBDevModePlugin\n      )\n    }\n\n    this.database = await createRxDatabase({\n      adapter: 'idb',\n      ...this.databaseOptions\n    })\n\n    database = this.database\n  }\n\n  destroyDatabase () {\n    return this.database.destroy()\n  }\n\n  async setupCollections () {\n    const collections = {}\n\n    for (const module of this.modules) {\n      collections[module.name] = module\n    }\n\n    this.collections = await this.database.addCollections(collections)\n\n    for (const module of this.modules) {\n      this.storeModules[module.name] = this.createStoreModule(module)\n    }\n  }\n\n  createStoreModule (module = {}) {\n    module.parent = this\n    const collection = this.getCollectionByName(module.name)\n\n    module.idKey = module.idKey || this.idKey\n    module.perPage = module.perPage || this.perPage\n\n    // Hooks\n    const hooks = module.hooks || {}\n\n    for (const name of this.hooks) {\n      const hook = hooks[name]\n\n      if (Array.isArray(hook)) {\n        collection[name](...hook)\n      } else if (typeof hook === 'function') {\n        collection[name](hook, false)\n      }\n    }\n\n    // Types\n    const types = module.types || this.types\n    const has = type => types.includes(type)\n\n    // Params\n    const params = [module, collection]\n\n    return {\n      namespaced: true,\n\n      actions: {\n        create: has('CREATE') && actions.create(...params),\n        destroy: has('DESTROY') && actions.destroy(...params),\n        fetchFilters: has('FETCH_FILTERS') && actions.fetchFilters(...params),\n        fetchList: has('FETCH_LIST') && actions.fetchList(...params),\n        fetchSingle: has('FETCH_SINGLE') && actions.fetchSingle(...params),\n        replace: has('REPLACE') && actions.replace(...params),\n        update: has('UPDATE') && actions.update(...params),\n        ...module.actions\n      },\n\n      getters: getters(...params),\n      mutations: mutations(...params),\n      state: state(...params)\n    }\n  }\n\n  getCollections () {\n    return this.collections\n  }\n\n  getCollectionByName (name) {\n    return this.collections[name]\n  }\n\n  getStoreModules () {\n    return this.storeModules\n  }\n\n  async makeSync (collections) {\n    const defaultOptions = {\n      waitForLeadership: true,\n      direction: {\n        pull: true,\n        push: true\n      },\n      options: {\n        retry: true,\n        live: true\n      }\n    }\n\n    const collectionsToSync = collections || Object.keys(this.collections)\n    const listDocumentsRead = []\n    const listTotalPending = []\n\n    const calculateSyncProgress = (syncState, listDocumentsRead, listTotalPending, collectionIndex, moduleByName) => {\n      syncState.change$.subscribe(({ change }) => {\n        if (this.sync.progress) {\n          if (!listTotalPending[collectionIndex]) {\n            listTotalPending[collectionIndex] = change.pending + change.docs_read\n          }\n    \n          listDocumentsRead[collectionIndex] = change.docs_read\n          \n          const total = sumList(listTotalPending)\n          const progress = sumList(listDocumentsRead)\n    \n          if (!change.pending) {\n            listTotalPending[collectionIndex] = 0\n            listDocumentsRead[collectionIndex] = 0\n          }\n  \n          this.sync.progress(Math.round((100 * progress) / total))\n        }\n  \n        if (moduleByName.sync && moduleByName.sync.progress) {\n          let totalPending = 0\n  \n          if (!totalPending) {\n            totalPending = change.pending + change.docs_read\n          }\n  \n          moduleByName.sync.progress(Math.round((100 * change.docs_read) / totalPending))\n        }\n      })\n    }\n\n    const sumList = (list) => {\n      return list.length ? list.reduce((accumulator, currentValue) => accumulator + currentValue) : list\n    }\n\n    for (const collectionIndex in collectionsToSync) {\n      const collectionName = collectionsToSync[collectionIndex]\n\n      const moduleByName = this.modules.find(module => module.name === collectionName)\n      const moduleOptions = (moduleByName.sync && moduleByName.sync.options) || {}\n      const syncOptions = { ...defaultOptions, ...this.sync.options, ...moduleOptions }\n\n      if (!syncOptions.baseURL) {\n        throw new Error('baseURL is required to sync.')\n      }\n\n      const syncState = await this.collections[collectionName].sync({\n        ...syncOptions,\n        remote: `${syncOptions.baseURL}/couchdb/${collectionName}`\n      })\n\n      if (moduleByName.sync && moduleByName.sync.handler) {\n        moduleByName.sync.handler(syncState)\n      }\n\n      if (this.sync.progress || (moduleByName.sync && moduleByName.sync.progress)) {\n        calculateSyncProgress(syncState, listDocumentsRead, listTotalPending, collectionIndex, moduleByName)\n      }\n    }\n  }\n}\n\nexport {\n  createDateTime,\n  createUUID,\n  database,\n  find,\n  findOne,\n  nestField,\n  PouchDB\n}\n"],"names":["name","query","database","collections","find","selector","exec","queryParam","_typeof","findOne","response","data","status","code","ptBR","localize","message","labelize","label","replace","error","RxError","parameters","databaseErrors","errors","result","obj","field","formatResponse","fields","type","callback","filteredFields","key","documents","value","map","document","toJSON","idKey","parent","relationships","JSON","parse","stringify","relationship","ref","options","setOptions","relKey","relRef","children","moduleFilters","filters","search","queryOperators","searchFilter","filtersQuery","filter","queryOperator","Error","parseJSON","operator","model","$or","item","$regex","RegExp","array","nestField","nested","destroyedKey","Array","isArray","index","hasNext","length","next","current","splice","defaults","text","collection","updateDefaults","commit","payload","id","setDefaults","statusResponse","getFieldsByType","update","$set","formatError","create","insert","documentJSON","destroy","module","remove","fetchFilters","fetchList","findQuery","increment","limit","page","getFindQuery","sort","count","skip","perPage","slicedDocuments","slice","documentsJSON","mapJSON","results","getFieldsWithRelationshipOptions","fetchSingle","form","getters","list","state","totalPages","byId","mutations","setFilters","setList","push","Math","ceil","setListItem","setErrors","hasError","replaceItem","findIndex","removeListItem","Date","toISOString","char","crypto","getRandomValues","Uint8Array","toString","databaseOptions","sync","modules","storeModules","hooks","types","plugins","plugin","addRxPlugin","addDatabasePlugin","RxDBValidatePlugin","RxDBQueryBuilderPlugin","RxDBMigrationPlugin","RxDBReplicationPlugin","RxDBLeaderElectionPlugin","RxDBUpdatePlugin","require","process","env","DEBUGGING","RxDBDevModePlugin","createRxDatabase","adapter","this","addCollections","createStoreModule","getCollectionByName","hook","has","includes","params","namespaced","actions","defaultOptions","waitForLeadership","direction","pull","retry","live","collectionsToSync","Object","keys","listDocumentsRead","listTotalPending","calculateSyncProgress","syncState","collectionIndex","moduleByName","change$","subscribe","change","_this","progress","pending","docs_read","total","sumList","round","totalPending","reduce","accumulator","currentValue","collectionName","moduleOptions","syncOptions","baseURL","remote","handler"],"mappings":"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"}